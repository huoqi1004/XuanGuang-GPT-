{
  "instruction":"说说分布式扫描器能实现对什么类型的漏洞进行检测。",
  "input":"",
  "output":"分布式扫描器适用于常见漏洞的扫描，其对漏洞类型没有要求，只要是通过发送数据包来验证漏洞是否存在的都可以，分布式只是将原来的一台机器扫描改成了多台同时扫描。"
}
{
  "instruction":"说说实现一个分布式扫描器的思路是什么样的。",
  "input":"",
  "output":"首先需要有爬虫程序,如果没有爬虫也可以使用流量镜像或proxy代理方式获取扫描链接存入数据库,然后要有一个可以用的扫描程序,将这个扫描程序分别部署几个节点,再此的基础上新增一个mastet节点,其作用是任务调度和规则下发模块,mastet节点通过读取数据库里面的待扫描链接,然后分别下发任务到各个节点进行扫描,扫描的结果再分别存储到数据库中。"
}
{
  "instruction":"说说分布式扫描器必备模块有哪些?哪一个模块是最重要的。",
  "input":"",
  "output":"中央存储数据库、中央任务和资源调度系统、请求收集模块（如爬虫和代理）,扫描引擎以及web管理控制端】其中,中央任务和资源调度系统最为重要,因为这是负责控制各个子模块的中枢系统。"
}
{
  "instruction":"说说推荐的几个分布式扫描器。",
  "input":"",
  "output":"飞刃(NextScan),Nray,matscan,OpenVAS。"
}
{
  "instruction":"说说在实现分布式扫描器的过程中遇到过什么问题?如何解决的。",
  "input":"",
  "output":"最复杂也是最棘手的问题应该就是中央任务和资源调度系统的设计，如何让各个子扫描系统彼此分离且不重复扫描，如何合理的分配扫描任务给多个字扫描系统,解决方法是，设置一个主队列存放所有搜集到的请求，然后让各个子扫描系统各自设置自己的从队列来接收来自主队列的扫描请求和任务，同时让字扫描节点定期回传自己的队列状态至中央任务和资源调度系统，在由其判断存在哪些空闲的扫描节点并分配更多的扫描任务。"
}
{
  "instruction":"说说怎么解决点击交互产生的请求。",
  "input":"",
  "output":"交互产生的请求可以模拟搜索页面中的click,button之类的使用类似于phantomjs之类的无界面浏览器引擎去解析页面中的js,流量镜像或者proxy代理也是一种有效的获取连接的方式。"
}
{
  "instruction":"说说分布式扫描器的优点。",
  "input":"",
  "output":",多节点多任务同时处理和扫描，大大地节省了扫描时间和周期。使用分布式扫描的主要优点是其降低了服务器负载和节省扫描时间。"
}
{
  "instruction":"说说为何S2-045与S2-046漏洞实际上是同一个漏洞呢。",
  "input":"",
  "output":"两者攻击点相同,都是因为使用的Jakarta插件造成的,只是攻击维度不同(S2-045利用位置是Content-Type,S2-046利用位置是Content-Dispostion/ Content-Length)。都是文件上传解析器jakarta的使用。都是error消息的处理,只是error的点不一样,一个是content-type,一个是content-length。"
}
{
  "instruction":"说说推荐的检测工具。",
  "input":"",
  "output":"OWASP ZAP, Struts2-Scan, Struts2vulsscantools等。"
}
{
  "instruction":"说说S2-045-046 getshell的方法。",
  "input":"",
  "output":"只要达到触发异常条件,把shellcode注入到content-type与filtename。"
}
{
  "instruction":"说说S2-045与S2-046漏洞与之前Struts2框架漏洞有何异呢。",
  "input":"",
  "output":"Struts2漏洞的根源基本都是对OGNL表达式的解析执行,Struts2框架漏洞的类型有很多,apache官网累积已发布46个struts框架漏洞,涉及到xss、文件遍历、CSRF攻击、远程命令执行等,其中命令执行类漏洞最多。像S2-045与S2-046漏洞就属于命令执行类漏洞。"
}
{
  "instruction":"说说如何检测S2-045与S2-046漏洞。",
  "input":"",
  "output":"struts2-core.x.x.jar的版本号。内部检查,check下框架版本。目前互联网上有不少验证该类漏洞的poc,可直接使用。"
}
{
  "instruction":"说说如何修复S2-045与S2-046漏洞。",
  "input":"",
  "output":"更新到 Struts 2.3.32 or Struts 2.5.10.1。针对struts2 Oday漏洞刚出来的时候也可以采用一些临时防御措施,针对POC字段,在waf上面或者应用本身添加filter。严格过滤 Content-Type、filename里的内容,严禁ognl表达式相关字段。"
}
{
  "instruction":"说说struts2-045、046的POC构造。",
  "input":"",
  "output":"大概需要的步骤:关键参数,验证方式,目标版本,编码问题,绕过WAF以及防御建议。"
}