{
 "instruction":"分布式扫描器能实现对什么类型的漏洞进行检测?",
 "input":"",
"output":"分布式扫描器适用于常见漏洞的扫描，其对漏洞类型没有要求，只要是通过发送数据包来验证漏洞是否存在的都可以，分布式只是将原来的一台机器扫描改成了多台同时扫描而已。基本上来说凡是具有请求应答的漏洞都可以检测。"
},
{
 "instruction":"实现一个分布式扫描器的思路是什么样的?",
 "input":"",
"output":"首先需要有爬虫程序，如果没有爬虫也可以使用流量镜像或 proxy 代理方式获取扫描链接存入数据库，然后要有一个可以用的扫描程序，将这个扫描程序分别部署几个节点，再此的基础上新增一个 mastet 节点，其作用是任务调度和规则下发模块， mastet 节点通过读取数据库里面的待扫描链接，然后分别下发任务到各个节点进行扫描，扫描的结果再分别存储到数据库中。。"
},
{
 "instruction":"分布式扫描器必备模块有哪些？哪一个模块是最重要的?",
 "input":"",
"output":"中央存储数据库、中央任务和资源调度系统、请求收集模块（如爬虫和代理），扫描引擎以及 web 管理控制端。其中，中央任务和资源调度系统最为重要，因为这是负责控制各个子模块的中枢系统，就像人的大脑一样,爬虫模块，数据解析模块，数据存储模块，漏洞扫描模块，任务调度模块。"
},
{
 "instruction":"在实现分布式扫描器的过程中遇到过什么问题？如何解决的?",
 "input":"",
"output":"最棘手的问题应该就是中央任务和资源调度系统的设计，如何让各个子扫描系统彼此分离且不重复扫描，如何合理的分配扫描任务给多个字扫描系统。这里我的解决方法是，设置一个主队列存放所有搜集到的请求，然后让各个子扫描系统各自设置自己的从队列来接收来自主队列的扫描请求和任务，同时让字扫描节点定期回传自己的队列状态至中央任务和资源调度系统，在由其判断存在哪些空闲的扫描节点并分配更多的扫描任务。"
},
{
 "instruction":"分布式扫描器的优点?",
 "input":"",
"output":"分布式扫描器的优点自然是多节点多任务同时处理和扫描，大大地节省了扫描时间和周期。使用分布式扫描的主要优点是其降低了服务器负载和节省扫描时间,比如说之前对全网域名做一次漏洞扫描需要10个小时,使用分布式扫描加入10多个节点同时进行时,扫描时间减少到1个小时。这对于范围性的进行漏洞验证效果还是挺显著的,而爬虫分布式部署也可以尽可能多的获取到连接,这对后面的漏洞检出有帮助。"
},
{
"instruction":"S2-045与S2-046漏洞的危害?",
"input":"",
"output":"官方评级该类漏洞为高危,也是一种0day,并不需要找个上传的地方只需要模拟上传发包。其中的 jakarta 解析器是 Struts 2框架的标准组成部分。"
},
{
"instruction":"S2-045与S2-046漏洞的原理,具体出现问题的原因?",
"input":"",
"output":"S2-045:struts . multipart . parser = jakarta (/ org / apache /struts2/default. properties )Content - Type 的解析错误 Content - Type 包含 OGNL 表达式。S2-046:< constant name =" struts . multipart . parser " value =" jakarta - stream "/> http 请求头中的 Content - Length 需要大于2097152文件名包含 OGNL 表达式。"
},
{
"instruction":"为什么说S2-045与S2-046漏洞实际上是一个漏洞呢?",
"input":"",
"output":"两者攻击点相同，都是因为使用的 Jakarta 插件造成的，只是攻击维度不同(S2-045利用位置是 Content - Type ,S2-046利用位置是Content - Dispostion / Content - Length )。都是文件上传解析器 jakarta 的使用。都是 error 消息的处理，只是 error 的点不一样，一个是 content - type ，一个是 content - length 。触发命令执行函数都是 LocalizedTextUtil . findText ();s2-046触发异常是因为文件大小超过规定,S2-045是 content - TYPE 。。"
},
{
"instruction":"推荐检测工具有哪些?",
"input":"",
"output":"检测工具 github 上有很多了。直接搜索S2-045或S2-046能找到不少。 apache 官方也有公开的 poc 进行检测。白帽子也开源了不少检测 poc 。"
},
{
"instruction":"S2-045与S2-046 getshell的方法?",
"input":"",
 "output":"只要达到触发异常条件,把shellcode注入到contant-type与filtename就行了 。"
},
{
"instruction":"S2-045与S2-046漏洞与之前Struts2框架漏洞有何异呢?",
"input":"",
"output":"Struts2漏洞的根源基本都是对 OGNL 表达式的解析执行。利用无需任何前置条件（ debug 等功能）以及启用任何插件 。"
},
{
"instruction":"如何修复S2-045与S2-046漏洞?",
"input":"",
"output":"针对struts20day漏洞刚出来的时候也可以采用一些临时防御措施,针对 POC 字段，在 waf 上面或者应用本身添加 filter 。严格过虑Content - Type 、 filename 里的内容，严禁 ognl 表达式相关字段。删除 commons - fileupload - x . x . x . jar 文件，不过文件上传不可用。 。"
},
{
"instruction":"如何检测S2-045与S2-046漏洞?",
"input":"",
"output":"现在批量扫描的工具也很多,struts2-core. x . x . jar 的版本号。目前互联网上有不少验证该类漏洞的 poc ，可直接使用 。"
},
{
"instruction":"struts2-045、046的 POC 构造?",
"input":"",
"output":"POC 的构造有很多啊。看下 POC 代码,或工具发包的时候抓包看下。调试的话.搭建环境.在struts2的入口类打断点就好 。"
},
{
    "instruction":"简单介绍一下什么是webshell?",
    "input":"",
    "output":"webshell实际上是一个在网站服务器可执行的脚本文件,例如ASP,PHP,JSP等,可通过此脚本 远程操控网站,通常攻击者入侵网站后都会上传webshell作为后门。Webshell:是以asp、php、jsp或者cgi等网页文件形式存在的一种命令执行环境,也可以将其称做为一种网页后门。在我理解就是一个与web服务相同的权限。"
   },
   {
    "instruction":"webshell有什么危害呢?",
    "input":"",
    "output":"一般webshell拥有文件上传、编辑、删除、重命名,执行系统命令、服务器管理,提权等功能。当网站被上传webshell就意味着你的网站已被入侵,攻击者基本上可以 对你的网站为所欲为，包括篡改你的网页，窃取或删除数据库数据等高危操作；通过提升权限还可以完全控制整个服务器；另外还可以作为跳板进行下一步的渗透。"
   },
   {
    "instruction":"检测 webshell 的重要性?",
    "input":"",
    "output":"检测 webshell 是对企业自身的互联网资产的安全建设必不可少的一个环节，实时检测 webshell 可对攻击者的入侵进行阻断，并可排查出漏洞所在，成为攻击者的拦路石。检测 webshell 是对企业自身的互联网资产的安全建设必不可少的一个环节，实时检测 webshell 可对攻击者的入侵进行阻断，并可排查出漏洞所在，成为攻击者的拦路石。"
   },
   {
   "instruction":"如何快速发现网站目录下的 webshell ?",
   "input":"",
   "output":"基于流量，基于 agent ，基于日志，但是还有一个国外在做的就是利用统计学。"
   },
   {
   "instruction":"目前常见的Webshell检测手段有哪些;原理是什么?",
   "input":"",
   "output":"键字匹配：即是对文件内容中的危险函数并可带入请求的关键字或是特定 webshell 的关键字进行匹配 通过搜集各种 webshell 样本组建正则进行匹配，还有危险的后缀名 。流量检测,通过收集发送请求的特征对网站的流量进行检测agent 检测：在服务器安装监控探针，根据 php 语言扫描编译的实现方式，进行剥离代码、注释，分析变量、函数、字符串、语言结构，来实现关键危险函数的捕捉方式。统计学检测：通过检测文件的信息熵，最长单词、 IC 值等数学方式判断文件是否危险。这种方法混淆加密的 webshll 检测有不错的作用。。"
   },
   {
   "instruction":"推荐几个成熟的Webshell检测工具?",
   "input":"",
   "output":"webshell 查杀工具支持所有脚本类型，可检测众多特殊函数和变量函数，效果非常不错。并有文件监控，进程监控等功能。河马网站后门检测与查杀工具：支持 linux , windows ，并提供在线检测 API 。Pecker Scanner ：是一个 PHP 语言编写的基于 php 语法扫描、词法分析的 webshell 扫描工具。该项目太久没更新了，但也值得借鉴。NeoPI ：是一个基于统计学的 webshell 检测脚本，支持关键字特征、信息熵、重合指数、最长单词等检测方式，对一些加密编码过的 webshell 识别不错，但是没有混淆过的就基本检测不出来。。"
   },