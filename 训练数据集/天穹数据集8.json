{
"instruction":"能说说XML注入的攻击原理么?",
"input":"",
"output":"XML 指可扩展标记语言,XML 被设计用来传输和存储数据。XML注入一般指在请求的XML数据中插入攻击利用代码,根据不同的场景,可能会形成以下的漏洞形式:xee  XML Entity Expansion,xxe XXE Injection即XML External Entity Injection,soap注入,XPath注入。"
},
{
    "instruction":"那XML注入形成原因呢?",
    "input":"",
    "output":"个人觉得,是因为研发人员对用户输入的XML内容没有做合法性校验,安全性过滤,没有了解过常见的危害。研发人员毕竟不是安全人员,仍然需要安全教育和培训指导。"
},
{
    "instruction":"诈骗的种类很多，针对恶意者来说，他们的目的和利益点分别是什么？",
    "input":"",
    "output":"获取用户更多信息实行另外的诈骗,直接通过该点进行获利。"
},
{
    "instruction":"XML注入的攻击方式有哪些呢?",
    "input":"",
    "output":"针对不同类型的xml注入,会有不同的攻击利用方式,比如soap注入就是利用sql注入的原理,而xxe、xee等,则需要借助实体来进行利用。"
},
{
    "instruction":"对于XML外部实体注入,如果读取的文件本身就是xml或者存在特殊字符的情况下,怎么能把他发送出来呢?主要是java和.net的。",
    "input":"",
    "output":"遇到这种,我们知道php可以使用php:// 协议base64-encode来读取,不同程序支持的协议不一样。"
},
{
    "instruction":"能说说XML注入攻击的危害么?",
    "input":"",
    "output":"通过构造恶意内容,可导致权限绕过及伪造、读取任意文件、执行系统命令、探测内网端口(SSRF等)、攻击内网网站等危害。还可能有DOS,也就是xee漏洞。soap注入的话,那么就是数据丢失。"
},
{
    "instruction":"检测XML注入攻击的小工具有哪些呢?",
    "input":"",
    "output":"BurpSuite,AWVS,或者自写Python脚本。"
},
{
    "instruction":"xpath注入的场景能列举一些吗?",
    "input":"",
    "output":"xpath注入的场景确实比较少,主要出现在利用xml进行数据存储的时候,也就是当使用 l取代 l这种数据库的功能时 我自己构造 个简单的场景 就是用 l进用xml取代mysql这种数据库的功能时。我自己构造了一个简单的场景,就是用xml进行用户信息存储的。在登陆的场景时候  当用户登录请求是以下情况时，就可以正常登陆：//user[username/text()='Jhon' and password/text()='123456']。如果有一个字段与xml存储的不一样就拒绝登陆,那么这个时候我们就可以利用sql注入绕过登陆的思路来了。构造以下请求可以登录//user[username/text()='John' and password/text()='' or 'a'='a']。"
},
{
    "instruction":"那如何预防XML注入呢?",
    "input":"",
    "output":"禁用外部实体:判断数据合法性;过滤非法数据。上层弄个WAF拦截和可疑数据包分析告警,应该也挺好。"
},
{
    "instruction":"请问如何发现弱口令的存在呢？",
    "input":"",
    "output":"内部方面,在系统上线前弱口令扫描;外部方面,应急响应接收。现在大多数公司都在这么做,现在网上的字典也是很强大的,企业在做安全的时候,主要是担心暴露在外网业务的弱口令。现在企业内外网隔离做的比较好的话,mysql、ssh、redis和mongodb的弱口令被扫到的话会少一点。."
    },
    {
        "instruction":"如何防范弱口令呢？",
        "intput":"",
        "output":"比方说供应商的订单系统，这种由于供应商的用户没有相关安全意识，他们的密码设置通常不会复杂。 所以，经常会出现供应商的账户泄露，导致订单泄露这种情况。 防范弱口令的话，虽然说安全意识很重要，但是这种无法把控，我觉得防范弱口令主要还是得系统有强制的密码策略。不允许用户设置简单密码，这样以来，弱口令出现的概率就小了很多。监控发现能力也很重要，另外为了防止暴力破解，还得定期修改密码。从技术层面考虑，可以开启认证。当然了，认证方式不能只局限在记住密码上，比如什么声纹鉴定、人脸识别、指纹识别，还可以双因子认证，完全可以把这些可用的多因素认证加进来。"
    },
    {
        "instruction":"登陆SSH 能人脸指纹嘛？",
        "input":"",
        "output":"当然可以了,self path pam,又不是没做过。输入密码之后,pam会连接到我们的二次认证服务器,然后需要用户自己打开二次认证服务器的页面做二次识别,在web上做人脸、声纹虽然不流行,但是技术上是可行的动态口令也是一个很典型的低成本的otp,otp和双因素不是一个维度上的概念,但是都可以用来缓解传统的密码问题。"
    },
    {
        "instruction":"能甩一个被利用引发的惨案么~",
        "input":"",
        "output":"出现比较多的弱口令血案应该是在一些web应用上。"
    },
    {
        "instruction":"如何方便记忆强口令呢？",
        "input":"",
        "output":"使用相对安全的口令，防止口令被穷举或字典法猜出，还应加强口令安全。主要措施如下：(1)口令长度不小于8位,并应包含字母,数字和其他字符,并且不包含全部或部分的用户账号名；(2)避免使用英文单词、生日、姓名、电话号码或这些信息的简单组合作为口令；(3)不要在不同的系统上使用相同的口令；(4)定期或不定期地修改口令；(5)使用口令设置工具生成健壮的口令； (6)对用户设置的口令进行检测，及时发现弱口令；(7)限制某些网络服务的登录次数，防止远程猜测、字典法、穷举法等攻击。"
    },
    {
        "instruction":"能说说XML注入攻击的危害么?",
        "input":"",
        "output":"通过构造恶意内容,可导致权限绕过及伪造、读取任意文件、执行系统命令、探测内网端口(SSRF等)、攻击内网网站等危害。还可能有DOS,也就是xee漏洞。soap注入的话,那么就是数据丢失。"
    },
    {
        "instruction":"那检测XML注入攻击的小工具有哪些呢?",
        "input":"",
        "output":"小工具的，有 BurpSuite,AWVS,或者自写Python脚本。"
    },
    {
        "instruction":"xpath注入的场景能列举一些吗?",
        "input":"",
        "output":"xpath注入的场景确实比较少,主要出现在利用xml进行数据存储的时候,也就是当使用 l取代 l这种数据库的功能时 我自己构造 个简单的场景 就是用 l进用xml取代mysql这种数据库的功能时。我自己构造了一个简单的场景,就是用xml进行用户信息存储的。在登陆的场景时候  当用户登录请求是以下情况时，就可以正常登陆：//user[username/text()='Jhon' and password/text()='123456']。如果有一个字段与xml存储的不一样就拒绝登陆,那么这个时候我们就可以利用sql注入绕过登陆的思路来了。构造以下请求可以登录//user[username/text()='John' and password/text()='' or 'a'='a']。"
    },